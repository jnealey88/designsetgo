/**
 * Sticky Header Utility Styles
 *
 * Provides comprehensive sticky header support for WordPress template parts.
 * Works in conjunction with WordPress's position:sticky support.
 *
 * @package DesignSetGo
 * @since 1.0.0
 */

/**
 * Core Sticky Header Support
 * Only applies when enabled globally (body class) OR per-block (template part class)
 * Targets semantic headers or explicitly enabled template parts
 * Note: Excludes footer elements to prevent unintended stickiness
 */
body:not(.block-editor-page).dsgo-sticky-header-enabled .wp-block-template-part:not(footer):first-of-type,
body:not(.block-editor-page).dsgo-sticky-header-enabled header.wp-block-template-part,
body:not(.block-editor-page) .wp-block-template-part.dsgo-sticky-header-enabled {
	position: sticky;
	top: 0;
	z-index: var(--dsgo-sticky-header-z-index, 100);
	transition: all var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
}

/**
 * Admin Bar Offset
 * Account for WordPress admin bar when user is logged in
 */
/* stylelint-disable selector-class-pattern */
body:not(.block-editor-page).admin-bar.dsgo-sticky-header-enabled .wp-block-template-part:not(footer):first-of-type,
body:not(.block-editor-page).admin-bar.dsgo-sticky-header-enabled header.wp-block-template-part,
body:not(.block-editor-page).admin-bar .wp-block-template-part.dsgo-sticky-header-enabled {
	top: 32px; /* WordPress admin bar height on desktop */
}

@media screen and (max-width: 782px) {

	body:not(.block-editor-page).admin-bar.dsgo-sticky-header-enabled .wp-block-template-part:not(footer):first-of-type,
	body:not(.block-editor-page).admin-bar.dsgo-sticky-header-enabled header.wp-block-template-part,
	body:not(.block-editor-page).admin-bar .wp-block-template-part.dsgo-sticky-header-enabled {
		top: 46px; /* WordPress admin bar height on mobile */
	}
}
/* stylelint-enable selector-class-pattern */

/* Remove sticky from inner block to avoid conflicts */
.wp-block-template-part .is-position-sticky {
	position: relative;
}

/**
 * Shadow on Scroll
 * Adds depth to the sticky header when scrolling
 */
.dsgo-sticky-shadow-small.wp-block-template-part.dsgo-scrolled {
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
}

.dsgo-sticky-shadow-medium.wp-block-template-part.dsgo-scrolled {
	box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.dsgo-sticky-shadow-large.wp-block-template-part.dsgo-scrolled {
	box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}

/**
 * Shrink on Scroll
 * Disabled - too complex to implement universally across different layouts
 */
.dsgo-sticky-shrink.wp-block-template-part {

	/* Feature disabled - classes preserved for backwards compatibility */
}

/**
 * Hide on Scroll Down
 * Auto-hides header when scrolling down, shows when scrolling up
 */
.dsgo-sticky-hide-on-scroll-down.wp-block-template-part {
	transition: transform var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
}

.dsgo-sticky-hide-on-scroll-down.wp-block-template-part.dsgo-scroll-down {
	transform: translateY(-100%);
}

.dsgo-sticky-hide-on-scroll-down.wp-block-template-part.dsgo-scroll-up {
	transform: translateY(0);
}

/**
 * Background on Scroll
 * Changes/adds background color when scrolling
 */
.dsgo-sticky-bg-on-scroll.wp-block-template-part {
	transition: background-color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out,
		color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
}

.dsgo-sticky-bg-on-scroll.wp-block-template-part.dsgo-scrolled {
	background-color: var(--dsgo-sticky-scroll-bg-color, rgba(255, 255, 255, 0.95));
	color: var(--dsgo-sticky-scroll-text-color, inherit);

	/* Apply text color to navigation elements only — excludes buttons with user-set colors */
	.wp-block-navigation a,
	.wp-block-navigation a:hover,
	.wp-block-navigation a:focus,
	.wp-block-navigation a:focus-visible,
	.wp-block-navigation a:visited,
	.wp-block-navigation a:active,
	.wp-block-navigation-item__content,
	.wp-block-navigation-item__label,
	.wp-block-navigation__submenu-icon,
	.wp-block-site-title a,
	.wp-block-site-title a:hover,
	.wp-block-site-title a:focus,
	.wp-block-site-title a:focus-visible,
	.wp-block-site-title a:visited,
	.wp-block-site-title a:active {
		color: var(--dsgo-sticky-scroll-text-color, inherit);
		transition: color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
	}

	/* Navigation SVG icons (hamburger, submenu arrows) */
	.wp-block-navigation__submenu-icon svg,
	.wp-block-navigation__responsive-container-open svg {
		fill: var(--dsgo-sticky-scroll-text-color, currentColor);
		transition: fill var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
	}
}

/**
 * Mobile Responsive Behavior
 * Disable sticky on mobile if configured
 */
@media (max-width: 767px) {

	.dsgo-sticky-mobile-disabled.wp-block-template-part {
		position: relative !important;
	}
}

/**
 * Accessibility: Respect prefers-reduced-motion
 */
@media (prefers-reduced-motion: reduce) {

	.wp-block-template-part,
	.dsgo-sticky-shrink.wp-block-template-part,
	.dsgo-sticky-hide-on-scroll-down.wp-block-template-part,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part .wp-block-navigation a,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part .wp-block-navigation-item__content,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part .wp-block-navigation-item__label,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part .wp-block-navigation__submenu-icon,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part .wp-block-site-title a,
	.dsgo-sticky-bg-on-scroll.wp-block-template-part svg,
	/* Overlay header text color transitions */
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type,
	body.dsgo-page-overlay-header header.wp-block-template-part,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type .wp-block-navigation a,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type .wp-block-navigation-item__content,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type .wp-block-navigation-item__label,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type .wp-block-navigation__submenu-icon,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type .wp-block-site-title a,
	body.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type svg {
		transition: none !important;
	}
}

/**
 * Dark Mode Support
 */
@media (prefers-color-scheme: dark) {

	.dsgo-sticky-shadow-small.wp-block-template-part.dsgo-scrolled {
		box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
	}

	.dsgo-sticky-shadow-medium.wp-block-template-part.dsgo-scrolled {
		box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
	}

	.dsgo-sticky-shadow-large.wp-block-template-part.dsgo-scrolled {
		box-shadow: 0 10px 15px rgba(0, 0, 0, 0.5);
	}

	.dsgo-sticky-bg-on-scroll.wp-block-template-part.dsgo-scrolled {
		background-color: var(--dsgo-sticky-scroll-bg-color, rgba(0, 0, 0, 0.95));
		color: var(--dsgo-sticky-scroll-text-color, rgba(255, 255, 255, 0.95));

		.wp-block-navigation a,
		.wp-block-navigation a:hover,
		.wp-block-navigation a:focus,
		.wp-block-navigation a:focus-visible,
		.wp-block-navigation a:visited,
		.wp-block-navigation a:active,
		.wp-block-navigation-item__content,
		.wp-block-navigation-item__label,
		.wp-block-navigation__submenu-icon,
		.wp-block-site-title a,
		.wp-block-site-title a:hover,
		.wp-block-site-title a:focus,
		.wp-block-site-title a:focus-visible,
		.wp-block-site-title a:visited,
		.wp-block-site-title a:active {
			color: var(--dsgo-sticky-scroll-text-color, rgba(255, 255, 255, 0.95));
		}

		.wp-block-navigation__submenu-icon svg,
		.wp-block-navigation__responsive-container-open svg {
			fill: var(--dsgo-sticky-scroll-text-color, rgba(255, 255, 255, 0.95));
		}
	}
}

/**
 * Print Styles
 * Remove sticky behavior for printing
 */
@media print {

	.wp-block-template-part {
		position: relative !important;
		box-shadow: none !important;
	}
}

/**
 * Overlay Header
 * Positions the header absolutely over page content when enabled via post meta.
 * The page must have the `dsgo-page-overlay-header` body class.
 */

/* stylelint-disable selector-class-pattern */

/**
 * Overlay: fix the header at the top of the viewport so it never scrolls
 * away. Background starts transparent and transitions to opaque on scroll
 * without any position change, avoiding the absolute→sticky jolt.
 */
body:not(.block-editor-page).dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type,
body:not(.block-editor-page).dsgo-page-overlay-header header.wp-block-template-part {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	z-index: var(--dsgo-sticky-header-z-index, 100);
	background-color: transparent;
	transition: background-color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out,
		box-shadow var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
}

/**
 * Overlay: force inner header sections transparent so they don't show
 * through over the hero. Uses :where() for zero specificity.
 */
body:not(.block-editor-page).dsgo-page-overlay-header :where(header.wp-block-template-part, .wp-block-template-part:not(footer):first-of-type) .has-background {
	background-color: transparent !important;
	background-image: none !important;
}

/**
 * Overlay Content Pull-Up
 * Uses a negative margin equal to the header height (set by JS as a CSS
 * custom property) so the content slides up underneath the overlay header
 * regardless of what spacing the template applies between header and content.
 */
body:not(.block-editor-page).dsgo-page-overlay-header .wp-site-blocks > header.wp-block-template-part + *,
body:not(.block-editor-page).dsgo-page-overlay-header .wp-site-blocks > .wp-block-template-part:not(footer):first-of-type + * {
	margin-top: calc(-1 * var(--dsgo-overlay-header-height, 0px)) !important;
}

/**
 * Overlay Header + Admin Bar Offset
 */
body:not(.block-editor-page).admin-bar.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type,
body:not(.block-editor-page).admin-bar.dsgo-page-overlay-header header.wp-block-template-part {
	top: 32px;
}

@media screen and (max-width: 782px) {

	body:not(.block-editor-page).admin-bar.dsgo-page-overlay-header .wp-block-template-part:not(footer):first-of-type,
	body:not(.block-editor-page).admin-bar.dsgo-page-overlay-header header.wp-block-template-part {
		top: 46px;
	}
}

/**
 * Overlay Scroll Background
 * When scrolled past threshold, fade in the solid background.
 * Position stays fixed — only background-color transitions.
 */
body:not(.block-editor-page).dsgo-page-overlay-header .wp-block-template-part.dsgo-scrolled:not(footer):first-of-type,
body:not(.block-editor-page).dsgo-page-overlay-header header.wp-block-template-part.dsgo-scrolled {
	background-color: var(--dsgo-sticky-scroll-bg-color, rgba(255, 255, 255, 0.95));
}

/**
 * Overlay Text Color
 * When a per-page overlay text color is set via the Header Display panel,
 * apply it to navigation links, site title, and SVG icons.
 * Only in the non-scrolled state — scroll text color takes over via
 * the dsgo-sticky-bg-on-scroll.dsgo-scrolled rules above.
 */
body:not(.block-editor-page).dsgo-page-overlay-header .wp-block-template-part:not(footer):not(.dsgo-scrolled):first-of-type,
body:not(.block-editor-page).dsgo-page-overlay-header header.wp-block-template-part:not(.dsgo-scrolled) {
	color: var(--dsgo-overlay-header-text-color, inherit);
	transition: color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;

	/* Navigation links */
	.wp-block-navigation a,
	.wp-block-navigation a:hover,
	.wp-block-navigation a:focus,
	.wp-block-navigation a:focus-visible,
	.wp-block-navigation a:visited,
	.wp-block-navigation a:active,
	.wp-block-navigation-item__content,
	.wp-block-navigation-item__label,
	.wp-block-navigation__submenu-icon,
	/* Site title */
	.wp-block-site-title a,
	.wp-block-site-title a:hover,
	.wp-block-site-title a:focus,
	.wp-block-site-title a:focus-visible,
	.wp-block-site-title a:visited,
	.wp-block-site-title a:active {
		color: var(--dsgo-overlay-header-text-color, inherit);
		transition: color var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
	}

	/* Navigation SVG icons (hamburger, submenu arrows) */
	.wp-block-navigation__submenu-icon svg,
	.wp-block-navigation__responsive-container-open svg {
		fill: var(--dsgo-overlay-header-text-color, currentColor);
		transition: fill var(--dsgo-sticky-header-transition-speed, 300ms) ease-in-out;
	}
}

/**
 * Overlay Header Print Styles
 */
@media print {

	body.dsgo-page-overlay-header .wp-block-template-part {
		position: relative !important;
		background-color: transparent !important;
	}
}
/* stylelint-enable selector-class-pattern */
