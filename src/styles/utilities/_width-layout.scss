/* stylelint-disable no-duplicate-selectors */

/**
 * Width & Layout Utilities
 *
 * Centralized width and layout rules for container blocks and their children.
 * This file defines how child blocks behave inside Section/Row/Grid containers.
 *
 * @since 1.0.1
 */

/**
 * ============================================================================
 * CONTAINER CHILD WIDTH STRATEGY
 * ============================================================================
 *
 * By default, all blocks inside containers (Section/Row/Grid) should span
 * the full width of their parent container. This provides consistent behavior
 * and prevents unexpected narrow layouts.
 *
 * Three categories of child block width behavior:
 * A. Full-Width Blocks (Default) - Most content blocks
 * B. Intrinsic Width Blocks (Inline) - Icon, Pill, etc.
 * C. User-Controlled Width - Blocks with alignment classes
 */

/**
 * A. Full-Width Blocks (Default Behavior)
 * ============================================================================
 *
 * All blocks inside container inner divs default to full width.
 * This includes:
 * - Container blocks (Section, Row, Grid)
 * - Interactive blocks (Accordion, Tabs)
 * - Most content blocks (Paragraph, Heading, Image, etc.)
 * - WordPress core blocks
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {

	> .wp-block {
		width: 100%;
		max-width: none;
	}
}

/**
 * B. Intrinsic Width Blocks (Inline Elements)
 * ============================================================================
 *
 * These blocks should maintain their natural inline sizing rather than
 * stretching to full width. Users can manually set width via alignment
 * or custom controls if needed.
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {
	// Icon blocks - inline by nature
	> .wp-block-designsetgo-icon {
		width: fit-content !important;
		max-width: fit-content !important;
		display: inline-flex;
	}

	// Icon Button - inline button with icon
	> .wp-block-designsetgo-icon-button {
		width: auto;
		display: inline-flex;
	}

	// Pill - inline badge/tag component
	> .wp-block-designsetgo-pill {
		width: auto;
		display: inline-flex;
	}

	// Counter - inline when no width set
	> .wp-block-designsetgo-counter:not([style*="width"]) {
		width: auto;
		display: inline-flex;
	}
}

/**
 * C. User-Controlled Width (WordPress Alignment)
 * ============================================================================
 *
 * Respect WordPress alignment classes. These override default full-width
 * behavior when users explicitly set alignment.
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {
	// Left-aligned blocks
	> .alignleft {
		width: auto;
		max-width: 50%;
		margin-right: 2em;
		float: left;
	}

	// Right-aligned blocks
	> .alignright {
		width: auto;
		max-width: 50%;
		margin-left: 2em;
		float: right;
	}

	// Center-aligned blocks
	> .aligncenter {
		width: auto;
		margin-left: auto;
		margin-right: auto;
	}
}

/**
 * ============================================================================
 * WORDPRESS CORE COMPATIBILITY
 * ============================================================================
 *
 * Ensure our blocks work seamlessly with WordPress's layout system.
 */

/**
 * Respect WordPress full-width alignment
 * When a block inside a constrained container is set to alignfull,
 * it should break out to full viewport width if theme supports it.
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {

	> .alignfull {
		width: 100vw;
		max-width: 100vw;
		margin-left: calc(50% - 50vw);
		margin-right: calc(50% - 50vw);
	}

	// Wide alignment uses theme's wide size
	> .alignwide {
		width: 100%;
		max-width: var(--wp--custom--layout--wide-size, 1200px);
		margin-left: auto;
		margin-right: auto;
	}
}

/**
 * WordPress Layout Classes
 * Work with WordPress's native layout system, not against it.
 */

// Container blocks using WordPress flex layout
.wp-block-designsetgo-section.is-layout-flex,
.wp-block-designsetgo-row.is-layout-flex,
.wp-block-designsetgo-grid.is-layout-flex {
	// WordPress handles flex layout via classes
	// Our custom styles augment, not replace
}

// Container blocks using WordPress constrained layout
.wp-block-designsetgo-section.is-layout-constrained,
.wp-block-designsetgo-row.is-layout-constrained,
.wp-block-designsetgo-grid.is-layout-constrained {
	// WordPress handles width constraints via classes
	// Our custom styles augment, not replace
}

/**
 * ============================================================================
 * NESTED CONTAINER BEHAVIOR
 * ============================================================================
 *
 * When a container is nested inside another container, the nested container
 * should span full width of its parent (not inherit parent's width constraint).
 * This allows nested containers to have their own width settings.
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {
	// Force nested containers to full width
	> .wp-block-designsetgo-section,
	> .wp-block-designsetgo-row,
	> .wp-block-designsetgo-grid {
		width: 100% !important;

		// Reset inner width constraints so nested container can set its own
		> .dsgo-stack__inner,
		> .dsgo-flex__inner,
		> .dsgo-grid__inner {
			max-width: none !important;
			margin-left: 0 !important;
			margin-right: 0 !important;
		}
	}
}

/**
 * ============================================================================
 * ACCORDION & TABS - ALWAYS FULL WIDTH
 * ============================================================================
 *
 * Interactive blocks should always fill parent container width.
 * Users should use Section/Row/Grid for layout if they want to constrain these.
 */
.dsgo-stack__inner,
.dsgo-flex__inner,
.dsgo-grid__inner {

	> .wp-block-designsetgo-accordion,
	> .wp-block-designsetgo-tabs {
		width: 100% !important;
		max-width: none !important;
	}
}

/**
 * ============================================================================
 * NO WIDTH CONSTRAINT MODE
 * ============================================================================
 *
 * When a container has constrainWidth=false (dsgo-no-width-constraint class),
 * ensure all children can use full width without constraint.
 */
.dsgo-stack.dsgo-no-width-constraint,
.dsgo-flex.dsgo-no-width-constraint,
.dsgo-grid.dsgo-no-width-constraint {

	> .dsgo-stack__inner,
	> .dsgo-flex__inner,
	> .dsgo-grid__inner {

		> :not(.alignleft):not(.alignright) {
			max-width: none !important;
		}
	}
}
