/**
 * Tabs Block - Frontend Styles
 */

// Ensure WordPress block wrapper doesn't cause overflow
.wp-block-designsetgo-tabs {
	max-width: 100%;
	box-sizing: border-box;

	// Override WordPress alignment negative margins
	&.alignfull,
	&.alignwide {
		margin-left: 0 !important;
		margin-right: 0 !important;
	}
}

.dsgo-tabs {
	position: relative;
	padding: 0; // Default to no padding
	width: 100%; // Fill container width
	max-width: 100%; // Prevent overflow beyond parent
	min-width: 0; // Allow shrinking in flex containers
	box-sizing: border-box; // Include padding/border in width calculation
	overflow: hidden; // Prevent child elements from overflowing
	margin-left: 0 !important; // Prevent WordPress negative margins
	margin-right: 0 !important; // Prevent WordPress negative margins

	// CSS custom properties for easy customization
	--dsgo-tabs-gap: 8px;
	--dsgo-tab-padding: var(--wp--preset--spacing--md, 1rem);
	--dsgo-tab-bg: transparent;
	--dsgo-tab-color: var(--wp--preset--color--contrast, #000);
	--dsgo-tab-bg-active: var(--wp--preset--color--accent-2, #2563eb);
	--dsgo-tab-color-active: var(--wp--preset--color--accent-2, #2563eb);
	--dsgo-tab-border-color: var(--wp--preset--color--accent-2, #2563eb);
	--dsgo-tab-border-radius: var(--wp--custom--designsetgo--border-radius--small, 0.25rem);
	--dsgo-tab-content-bg: transparent;

	/**
	 * Skip Link (Accessibility)
	 * Visually hidden until focused - allows keyboard users to skip tab navigation
	 */
	.dsgo-tabs__skip-link {
		position: absolute;
		left: -9999px;
		top: auto;
		width: 1px;
		height: 1px;
		overflow: hidden;

		&:focus {
			position: static;
			width: auto;
			height: auto;
			padding: 0.5rem 1rem;
			background: var(--wp--preset--color--accent-2, #2563eb);
			color: var(--wp--preset--color--base, #fff);
			text-decoration: none;
			border-radius: 4px;
			font-weight: 600;
			margin-right: auto;
			order: -1; // Ensure it appears first in flexbox
		}
	}

	/**
	 * Tab Navigation
	 */
	.dsgo-tabs__nav {
		display: flex;
		gap: var(--dsgo-tabs-gap);
		margin-bottom: var(--wp--preset--spacing--md, 1.5rem);
		overflow-x: auto;
		-webkit-overflow-scrolling: touch;

		// Hide scrollbar in most browsers but keep functionality
		scrollbar-width: thin;
		scrollbar-color: rgba(0, 0, 0, 0.2) transparent;

		&::-webkit-scrollbar {
			height: 4px;
		}

		&::-webkit-scrollbar-track {
			background: transparent;
		}

		&::-webkit-scrollbar-thumb {
			background: rgba(0, 0, 0, 0.2);
			border-radius: 2px;
		}
	}

	/**
	 * Optional Nav Border
	 * Shows a divider line below the tab navigation when enabled
	 */
	&.dsgo-tabs--show-nav-border .dsgo-tabs__nav {
		border-bottom: 1px solid rgba(0, 0, 0, 0.1);
		padding-bottom: 0.5rem;
	}

	/**
	 * Individual Tab Buttons
	 */
	.dsgo-tabs__tab {
		display: inline-flex;
		align-items: center;
		gap: 0.5rem;
		padding: var(--dsgo-tab-padding);
		background: var(--dsgo-tab-bg, transparent);
		border: none;
		color: var(--dsgo-tab-color, inherit);
		font-family: inherit;
		font-size: inherit;
		font-weight: 500;
		cursor: pointer;
		transition: all 0.2s ease;
		position: relative;
		white-space: nowrap;

		&:hover:not(.is-active) {
			color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
		}

		&:focus,
		&:focus-visible {
			outline: none;
		}

		&.is-active {
			background: var(--dsgo-tab-bg-active, transparent);
			color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			font-weight: 600;
		}

		.dsgo-tabs__tab-icon {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 20px;
			height: 20px;
			flex-shrink: 0;
			color: currentcolor;

			svg {
				width: 100%;
				height: 100%;
				fill: currentcolor;
				color: currentcolor;
			}
		}

		.dsgo-tabs__tab-icon-top {
			display: flex;
			flex-direction: column;
			align-items: center;
			margin-bottom: 0.25rem;
			color: currentcolor;

			svg {
				fill: currentcolor;
				color: currentcolor;
			}
		}
	}

	/**
	 * Tab Panels Container
	 * No typography - let child blocks inherit from body/theme naturally
	 */
	.dsgo-tabs__panels {
		position: relative;
		width: 100%;
		max-width: 100%;
		min-width: 0;
		box-sizing: border-box;
	}

	/**
	 * Individual Tab Panel
	 */
	.dsgo-tab {
		display: none;
		width: 100%;
		max-width: 100%;
		min-width: 0;
		box-sizing: border-box;
		background: var(--dsgo-tab-content-bg, transparent);

		&.is-active {
			display: block;
		}

		&[hidden] {
			display: none;
		}
	}

	/**
	 * Tab Content Wrapper
	 * No additional styles needed - padding/background applied to .dsgo-tab
	 */

	/**
	 * Orientation: Horizontal (Default)
	 */
	&.dsgo-tabs--horizontal {

		.dsgo-tabs__nav {
			flex-direction: row;
			flex-wrap: wrap;
		}

		// Alignment options
		&.dsgo-tabs--align-left .dsgo-tabs__nav {
			justify-content: flex-start;
		}

		&.dsgo-tabs--align-center .dsgo-tabs__nav {
			justify-content: center;
		}

		&.dsgo-tabs--align-right .dsgo-tabs__nav {
			justify-content: flex-end;
		}

		&.dsgo-tabs--align-justified .dsgo-tabs__nav {

			.dsgo-tabs__tab {
				flex: 1;
				justify-content: center;
			}
		}
	}

	/**
	 * Orientation: Vertical
	 */
	&.dsgo-tabs--vertical {
		display: flex;
		gap: var(--wp--preset--spacing--md, 1.5rem);

		.dsgo-tabs__nav {
			flex-direction: column;
			margin-bottom: 0;
			padding-right: var(--wp--preset--spacing--md, 1.5rem);
			min-width: 200px;
			overflow: visible; // Remove horizontal scrollbar for vertical tabs
		}

		.dsgo-tabs__panels {
			flex: 1;
		}
	}

	/**
	 * Tab Style: Default
	 * Simple text-only style with no borders or backgrounds
	 */
	&.dsgo-tabs--default {

		.dsgo-tabs__tab {

			&:hover:not(.is-active) {
				background: transparent;
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}

			&.is-active {
				background: transparent;
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}
		}
	}

	/**
	 * Tab Style: Pills
	 */
	&.dsgo-tabs--pills {
		// Override color variable for pills - white text on colored background
		--dsgo-tab-color-active: #fff;

		.dsgo-tabs__nav {
			border-bottom: none;
		}

		.dsgo-tabs__tab {
			background: var(--dsgo-tab-bg, rgba(0, 0, 0, 0.05));
			border-radius: var(--dsgo-tab-border-radius);
			border-bottom: none;
			margin-bottom: 0;

			&:hover:not(.is-active) {
				background: var(--dsgo-tab-bg, rgba(0, 0, 0, 0.1));
				color: var(--wp--preset--color--accent-2, #2563eb);
			}

			&.is-active {
				background: var(--dsgo-tab-bg-active, var(--wp--preset--color--accent-2, #2563eb));
				color: var(--dsgo-tab-color-active, #fff);
			}
		}
	}

	/**
	 * Tab Style: Underline
	 */
	&.dsgo-tabs--underline {

		.dsgo-tabs__nav {
			border-bottom: 1px solid rgba(0, 0, 0, 0.1);
		}

		.dsgo-tabs__tab {
			padding-bottom: calc(var(--dsgo-tab-padding) + 0.5rem);
			border-bottom: 2px solid transparent;
			margin-bottom: -1px; // Overlap the nav border
			background: transparent; // No background by default for underline style

			&:hover:not(.is-active) {
				background: transparent; // Keep transparent on hover
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}

			&.is-active {
				border-bottom-color: var(--dsgo-tab-border-color, var(--wp--preset--color--accent-2, #2563eb));
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
				background: transparent; // Keep transparent even when active
			}
		}
	}

	/**
	 * Vertical + Underline
	 */
	&.dsgo-tabs--vertical.dsgo-tabs--underline {

		.dsgo-tabs__tab {
			border-bottom: 2px solid transparent;
			margin-right: 0;

			&:hover:not(.is-active) {
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}

			&.is-active {
				border-bottom-color: var(--dsgo-tab-border-color, var(--wp--preset--color--accent-2, #2563eb));
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}
		}
	}

	/**
	 * Tab Style: Minimal
	 */
	&.dsgo-tabs--minimal {
		// Override defaults for minimal style - use light gray background with blue text
		--dsgo-tab-bg-active: rgba(0, 0, 0, 0.03);

		.dsgo-tabs__nav {
			border-bottom: none;
		}

		.dsgo-tabs__tab {
			padding: 0.5rem 1rem;
			border-bottom: none;
			margin-bottom: 0;

			&:hover:not(.is-active) {
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}

			&.is-active {
				background: var(--dsgo-tab-bg-active);
				color: var(--dsgo-tab-color-active, var(--wp--preset--color--accent-2, #2563eb));
			}
		}

		// When user customizes background to a color (via inline styles), use white text for contrast
		&[style*="--dsgo-tab-bg-active"] .dsgo-tabs__tab.is-active {
			color: var(--wp--preset--color--base, #fff);
		}
	}

	/**
	 * Mobile: Accordion Mode
	 */
	&.dsgo-tabs--accordion {

		.dsgo-tabs__nav {
			display: none;
		}

		.dsgo-tab {
			display: block !important; // Force all tabs visible in accordion mode
			border: 1px solid rgba(0, 0, 0, 0.1);
			border-radius: var(--dsgo-tab-border-radius);
			margin-bottom: 0.5rem;
			padding: 0; // Remove any padding from tab panel itself
			overflow: hidden; // Ensure content doesn't create extra space
			min-height: 0 !important; // Override editor min-height for accordion mode

			.dsgo-tab__accordion-header {
				width: 100%;
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: var(--dsgo-tab-padding);
				background: rgba(0, 0, 0, 0.02);
				border: none;
				border-bottom: 1px solid rgba(0, 0, 0, 0.1);
				font-family: inherit;
				font-size: inherit;
				font-weight: 600;
				cursor: pointer;
				text-align: left;

				&::after {
					content: '\25BC'; // Down arrow
					font-size: 0.75em;
					transition: transform 0.2s ease;
				}

				&[aria-expanded='true']::after {
					transform: rotate(180deg);
				}

				&:hover {
					background: rgba(0, 0, 0, 0.05);
				}
			}

			.dsgo-tab__content {
				padding: var(--dsgo-tab-padding);
			}

			&:not(.is-active) {

				.dsgo-tab__content {
					display: none !important; // Force content to be completely hidden when inactive
					height: 0 !important; // Collapse height to prevent space
					padding: 0 !important; // Remove padding when collapsed
					overflow: hidden !important; // Ensure nothing shows
				}
			}
		}
	}

	/**
	 * Mobile: Dropdown Mode
	 */
	&.dsgo-tabs--dropdown {

		.dsgo-tabs__nav {
			display: none;
		}

		.dsgo-tabs__dropdown {
			width: 100%;
			padding: var(--dsgo-tab-padding);
			font-family: inherit;
			font-size: inherit;
			font-weight: 500;
			border: 1px solid rgba(0, 0, 0, 0.2);
			border-radius: var(--dsgo-tab-border-radius);
			background: var(--dsgo-tab-bg);
			color: var(--dsgo-tab-color);
			cursor: pointer;
			margin-bottom: var(--wp--preset--spacing--md, 1.5rem);

			&:focus-visible {
				outline: none;
			}
		}
	}

	/**
	 * Mobile Breakpoint
	 */
	&.is-mobile {
		// Mobile-specific overrides
	}
}

/**
 * Animation: Fade In
 */
@keyframes dsgo-tab-fade-in {

	from {
		opacity: 0;
		transform: translateY(10px);
	}

	to {
		opacity: 1;
		transform: translateY(0);
	}
}

.dsgo-tab.is-active {
	animation: dsgo-tab-fade-in 0.3s ease;
}

/**
 * Accessibility: Reduced Motion
 */
@media (prefers-reduced-motion: reduce) {

	.dsgo-tabs__tab,
	.dsgo-tab {
		transition: none;
		animation: none;
	}
}

/**
 * Responsive: Mobile
 */
@media (max-width: 767px) {

	.dsgo-tabs {
		// Default to accordion on mobile
		&:not([data-mobile-mode='tabs']) {

			.dsgo-tabs__nav {
				overflow-x: auto;
				scrollbar-width: thin;

				&::-webkit-scrollbar {
					height: 6px;
				}

				&::-webkit-scrollbar-track {
					background: rgba(0, 0, 0, 0.05);
				}

				&::-webkit-scrollbar-thumb {
					background: rgba(0, 0, 0, 0.2);
					border-radius: 3px;
				}
			}
		}
	}

	.dsgo-tabs--vertical {
		flex-direction: column;

		.dsgo-tabs__nav {
			border-right: none;
			border-bottom: 2px solid rgba(0, 0, 0, 0.1);
			padding-right: 0;
			margin-bottom: var(--wp--preset--spacing--md, 1.5rem);
			min-width: 0;
		}
	}
}
