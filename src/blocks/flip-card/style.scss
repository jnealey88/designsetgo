/**
 * Flip Card Block - Frontend Styles
 *
 * JavaScript-based flip animation (much more reliable than CSS 3D transforms)
 *
 * @since 1.0.0
 */

.dsgo-flip-card {
	position: relative;
	width: 100%;

	&__container {
		position: relative;
		width: 100%;
		// CRITICAL: Use CSS Grid to overlay both cards while both contribute to height
		display: grid;
		grid-template-columns: 1fr;
		// Both cards in same grid cell, grid auto-sizes to tallest
		grid-template-rows: minmax(0, 1fr);
	}

	// Both front and back - ensure proper box sizing
	&__container > * {
		width: 100%;
		height: 100%; // Fill container so both cards match height
		box-sizing: border-box;
		transition: opacity var(--dsgo-flip-duration, 0.6s) ease,
			transform var(--dsgo-flip-duration, 0.6s) ease;
		// CRITICAL: Both occupy the same grid cell
		grid-column: 1;
		grid-row: 1;
		// Allow content to overflow grid for height calculation
		align-self: start;
	}

	// Front face (visible by default) - use exact class names
	&__container > .wp-block-designsetgo-flip-card-front,
	&__container > .dsgo-flip-card__front {
		opacity: 1;
		transform: rotateY(0deg);
		z-index: 2;
	}

	// Back face (hidden by default) - use exact class names
	&__container > .wp-block-designsetgo-flip-card-back,
	&__container > .dsgo-flip-card__back {
		opacity: 0;
		transform: rotateY(180deg);
		z-index: 1;
		pointer-events: none;
	}

	// When flipped (JS adds this class)
	&.is-flipped {
		// Hide front
		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
		.dsgo-flip-card__container > .dsgo-flip-card__front {
			opacity: 0;
			transform: rotateY(-180deg);
			pointer-events: none;
		}

		// Show back
		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
		.dsgo-flip-card__container > .dsgo-flip-card__back {
			opacity: 1;
			transform: rotateY(0deg);
			z-index: 2;
			pointer-events: auto;
		}
	}

	// Vertical flip direction (rotateX instead of rotateY)
	&--vertical {

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
		.dsgo-flip-card__container > .dsgo-flip-card__front {
			transform: rotateX(0deg);
		}

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
		.dsgo-flip-card__container > .dsgo-flip-card__back {
			transform: rotateX(180deg);
		}

		&.is-flipped {

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
			.dsgo-flip-card__container > .dsgo-flip-card__front {
				transform: rotateX(-180deg);
			}

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
			.dsgo-flip-card__container > .dsgo-flip-card__back {
				transform: rotateX(0deg);
			}
		}
	}

	// Click trigger
	&--click {
		cursor: pointer;

		&:focus {
			outline: none;
		}
	}

	// Hover trigger
	&--hover {

		&:focus {
			outline: none;
		}
	}

	// ===== FADE EFFECT =====
	&--effect-fade {

		.dsgo-flip-card__container > * {
			transform: none !important;
		}

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
		.dsgo-flip-card__container > .dsgo-flip-card__back {
			transform: none !important;
		}

		&.is-flipped {

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
			.dsgo-flip-card__container > .dsgo-flip-card__front {
				transform: none !important;
			}

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
			.dsgo-flip-card__container > .dsgo-flip-card__back {
				transform: none !important;
			}
		}
	}

	// ===== SLIDE EFFECT =====
	&--effect-slide {

		.dsgo-flip-card__container {
			overflow: hidden;
		}

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
		.dsgo-flip-card__container > .dsgo-flip-card__front {
			transform: translateX(0);
		}

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
		.dsgo-flip-card__container > .dsgo-flip-card__back {
			transform: translateX(100%);
		}

		&.is-flipped {

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
			.dsgo-flip-card__container > .dsgo-flip-card__front {
				transform: translateX(-100%);
			}

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
			.dsgo-flip-card__container > .dsgo-flip-card__back {
				transform: translateX(0);
			}
		}

		// Vertical slide for vertical direction
		&.dsgo-flip-card--vertical {

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
			.dsgo-flip-card__container > .dsgo-flip-card__front {
				transform: translateY(0);
			}

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
			.dsgo-flip-card__container > .dsgo-flip-card__back {
				transform: translateY(100%);
			}

			&.is-flipped {

				.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
				.dsgo-flip-card__container > .dsgo-flip-card__front {
					transform: translateY(-100%);
				}

				.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
				.dsgo-flip-card__container > .dsgo-flip-card__back {
					transform: translateY(0);
				}
			}
		}
	}

	// ===== ZOOM EFFECT =====
	&--effect-zoom {

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
		.dsgo-flip-card__container > .dsgo-flip-card__front {
			transform: scale(1);
		}

		.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
		.dsgo-flip-card__container > .dsgo-flip-card__back {
			transform: scale(0.8);
		}

		&.is-flipped {

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-front,
			.dsgo-flip-card__container > .dsgo-flip-card__front {
				transform: scale(1.2);
			}

			.dsgo-flip-card__container > .wp-block-designsetgo-flip-card-back,
			.dsgo-flip-card__container > .dsgo-flip-card__back {
				transform: scale(1);
			}
		}
	}
}

// Accessibility: Reduce motion preference
@media (prefers-reduced-motion: reduce) {

	.dsgo-flip-card__container > * {
		transition: opacity 0.1s ease;
		transform: none !important;
	}

	.dsgo-flip-card.is-flipped {

		.dsgo-flip-card__container > [class*="flip-card-front"] {
			transform: none;
		}

		.dsgo-flip-card__container > [class*="flip-card-back"] {
			transform: none;
		}
	}
}
