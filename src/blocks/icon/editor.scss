/**
 * Icon Block - Editor Styles
 *
 * Editor-specific styles and icon picker
 */

@use './components/icon-picker';

.dsgo-icon {
	// Editor-specific styles to improve UX
	position: relative;
	width: fit-content;
	max-width: fit-content; // Prevent expansion beyond content
	min-width: 48px; // Ensure block is always visible in editor
	min-height: 48px;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	line-height: 1; // Prevent inherited line-height (1.4) from creating extra vertical space

	// Selected state
	&.is-selected {
		outline: 1px solid var(--wp-admin-theme-color, #007cba);
		outline-offset: 2px;
		border-radius: 4px;
	}

	// Hover state in editor
	&.is-hovered {
		outline: 1px dashed var(--wp-admin-theme-color, #007cba);
		outline-offset: 2px;
		border-radius: 4px;
	}

	// Icon wrapper - matches frontend (style.scss)
	// CRITICAL: Must be duplicated from style.scss for editor/frontend parity
	&__wrapper {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		line-height: 1;
		color: currentcolor;
		transition: background-color 0.2s ease, color 0.2s ease;
		width: fit-content;

		// Ensure inline SVGs fill the wrapper (editor renders SVGs directly via React,
		// unlike the frontend which lazy-loads them into empty divs)
		svg {
			display: block;
			width: 100%;
			height: 100%;
		}

		.dashicons {
			display: block;
			width: 1em;
			height: 1em;
			font-size: inherit;
			line-height: 1;
			transition: transform 0.2s ease;
		}

		// Ensure shapes are square (1:1 aspect ratio)
		&.shape-circle,
		&.shape-square,
		&.shape-rounded {
			aspect-ratio: 1;
		}

		// Shape variants
		&.shape-circle {
			border-radius: 50%;
		}

		&.shape-square {
			border-radius: 0;
		}

		&.shape-rounded {
			border-radius: 8px;
		}
	}

	// WordPress color support applies background to this outer element.
	// The wrapper must stay transparent to prevent double-layered backgrounds
	// (two stacked semi-transparent layers would appear darker over the icon).
	&.has-background .dsgo-icon__wrapper,
	&[style*="background-color"] .dsgo-icon__wrapper {
		background-color: transparent !important;
	}

	// Accessibility: Respect prefers-reduced-motion (editor context)
	@media (prefers-reduced-motion: reduce) {

		&__wrapper,
		.dashicons {
			transition: none;
		}
	}
}

// CRITICAL: Must be duplicated from style.scss for editor/frontend parity
// Outlined icon style
.dsgo-icon-outlined {

	svg {
		fill: none !important;
		stroke: currentcolor;
		stroke-width: var(--icon-stroke-width, 1.5);
		stroke-linecap: round;
		stroke-linejoin: round;

		// Ensure all paths and shapes use stroke
		* {
			fill: none !important;
			stroke: currentcolor;
		}
	}
}

// CRITICAL: Must duplicate from style.scss for editor/frontend parity
// Parent container hover: apply icon background when parent is hovered
// Uses CSS variable set by parent container (Flex, Grid, Stack)
// CRITICAL: Check if PARENT container has the variable, not the icon itself
// CRITICAL: Use __inner wrapper to avoid triggering on outer padding areas
// CRITICAL: Exclude icons that are inside nested containers
// This changes the block's background color, which the wrapper inherits
.dsgo-flex[style*="--dsgo-parent-hover-icon-bg"]:hover .dsgo-flex__inner > .dsgo-icon,
.dsgo-grid[style*="--dsgo-parent-hover-icon-bg"]:hover .dsgo-grid__inner > .dsgo-icon,
.dsgo-stack[style*="--dsgo-parent-hover-icon-bg"]:hover .dsgo-stack__inner > .dsgo-icon {
	background-color: var(--dsgo-parent-hover-icon-bg) !important;
	transition: background-color 0.3s ease;
}
