/**
 * Stack Container Block - Frontend Styles
 *
 * Minimal frontend styles - WordPress handles flex layout through .is-layout-flex class.
 *
 * @package DesignSetGo
 */

.dsg-stack {
	// CRITICAL: Ensure width includes padding to prevent overflow
	box-sizing: border-box;

	// Smooth transition for hover background color
	transition: background-color 0.3s ease;

	// CRITICAL: Disable float for all children in flex layout
	// WordPress core CSS applies float for alignment classes (.alignleft, .alignright)
	// but float should not work inside flex containers
	&.is-layout-flex > * {
		float: none !important;
	}

	// CRITICAL: Ensure flex layout properties work correctly
	// WordPress applies these via inline styles, but we ensure they're respected
	&.is-layout-flex {
		display: flex;
		flex-direction: column; // Vertical stacking

		// CRITICAL: For vertical flex (column), horizontal centering uses align-items
		// WordPress's justifyContent controls vertical alignment
		// We need to also support horizontal centering
		&[style*="justify-content:center"],
		&[style*="justify-content: center"] {
			align-items: center; // Horizontal centering for column direction
		}

		&[style*="justify-content:right"],
		&[style*="justify-content: right"],
		&[style*="justify-content:flex-end"],
		&[style*="justify-content: flex-end"] {
			align-items: flex-end; // Right alignment for column direction
		}

		// Default left alignment
		align-items: flex-start;

		// CRITICAL: Inline/shrink-wrap blocks should respect alignment
		// These blocks should shrink to content width so they can be centered/aligned
		> .dsg-pill,
		> .wp-block-button,
		> .wp-block-buttons {
			align-self: flex-start; // Override to allow alignment
			width: auto !important; // Shrink to content
			max-width: none !important; // Remove WordPress's 1200px contentSize constraint
		}

		// CRITICAL: Block-level elements take full width by default
		// Text blocks, groups, and most WordPress blocks
		> .wp-block-heading,
		> .wp-block-paragraph,
		> .wp-block-group,
		> .wp-block-image,
		> .wp-block-video,
		> .wp-block-embed,
		> .wp-block-table,
		> .wp-block-list {
			width: 100%;
		}

		// Gap is handled by WordPress's blockGap support
	}

	// Hover background and text colors using CSS custom properties
	// CRITICAL: Only apply hover when variables are actually set on THIS element
	&:hover {
		// Only apply background if hover background is set
		&[style*="--dsg-hover-bg-color"] {
			background-color: var(--dsg-hover-bg-color);
		}

		// Only apply text color if hover text color is set
		&[style*="--dsg-hover-text-color"] {
			color: var(--dsg-hover-text-color) !important;

			// Apply text color to all text elements for consistency
			h1, h2, h3, h4, h5, h6, p, a, span, li, td, th,
			.wp-block-heading,
			.wp-block-paragraph {
				color: var(--dsg-hover-text-color) !important;
			}
		}
	}
}

// CRITICAL: Override WordPress's generated contentSize constraints for inline blocks
// WordPress generates rules like .wp-container-{block}-is-layout-{hash} > :where(...) { max-width: 1200px }
// We need to override these for blocks that should shrink to content
[class*="wp-container-designsetgo-stack"] {

	> .dsg-pill,
	> .wp-block-designsetgo-pill,
	> .wp-block-button,
	> .wp-block-buttons {
		width: auto !important;
		max-width: none !important;
	}
}

// CRITICAL: When Stack is full-width (alignfull), allow child blocks to also go full-width
// WordPress constrains children with max-width: 1200px by default via generated classes like:
// .wp-container-designsetgo-stack-is-layout-{hash} > :where(:not(.alignleft):not(.alignright):not(.alignfull))
// The WordPress container class is on the INNER div, not the outer div
// We need higher specificity to override this
.dsg-stack.alignfull > .dsg-stack__inner[class*="wp-container-"] {

	// Target all direct children that aren't explicitly aligned
	> :not(.alignleft):not(.alignright) {
		max-width: none !important;
		margin-left: 0 !important;
		margin-right: 0 !important;
	}
}
