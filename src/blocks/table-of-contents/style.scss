/**
 * Table of Contents Block - Frontend Styles
 */

.dsgo-table-of-contents {
    // CSS custom properties for user-controlled values
    --dsgo-toc-link-color: currentColor;
    --dsgo-toc-active-link-color: var(--wp--preset--color--primary, #0073aa);
    --dsgo-toc-indent: 1.5rem;

    position: relative;

    &__content {
        position: relative;
        display: flex;
        flex-direction: column;
        // Use WordPress block gap if set, otherwise fallback to 1rem
        gap: var(--wp--style--block-gap, 1rem);
    }

    &__title {
        font-size: 1.25rem;
        font-weight: 600;
        margin: 0;
        color: inherit;
    }

    &__list {
        list-style: none;
        padding-left: 0;
        margin: 0;
        line-height: 1.6;
        display: flex;
        flex-direction: column;
        // Inherit gap from content wrapper (which gets WordPress block gap)
        gap: inherit;

        // Nested sublists
        &.dsgo-table-of-contents__sublist {
            margin-top: 0.5rem;
            padding-left: var(--dsgo-toc-indent);
        }
    }

    &__item {
        // Spacing handled by flex gap on parent list

        // Active item styling
        &--active {
            > .dsgo-table-of-contents__link {
                font-weight: 600;
            }
        }
    }

    &__link {
        color: var(--dsgo-toc-link-color);
        text-decoration: none;
        transition: color 0.2s ease, text-decoration 0.2s ease;
        display: inline-block;

        &:hover {
            text-decoration: underline;
        }

        &:focus {
            outline: 2px solid var(--dsgo-toc-active-link-color);
            outline-offset: 2px;
        }

        // Active link highlighting
        &--active {
            color: var(--dsgo-toc-active-link-color);
            font-weight: 600;
        }
    }

    &__empty {
        color: #666;
        font-style: italic;
    }

    // Ordered list styling
    &--ordered {
        .dsgo-table-of-contents__list {
            list-style: decimal;
            padding-left: 1.5rem;

            &.dsgo-table-of-contents__sublist {
                list-style: lower-alpha;
            }
        }
    }

    // Flat display mode - no indentation for sublists
    &--flat {
        .dsgo-table-of-contents__sublist {
            padding-left: 0;
        }
    }

    // Hierarchical display mode - maintain indentation
    &--hierarchical {
        .dsgo-table-of-contents__sublist {
            padding-left: var(--dsgo-toc-indent);
        }
    }

    // Mobile: Collapsible TOC
    @media (max-width: 782px) {
        &__content {
            max-height: 400px;
            overflow-y: auto;
            overflow-x: hidden;

            // Smooth scrolling within TOC on mobile
            scroll-behavior: smooth;

            // Scrollbar styling (webkit browsers)
            &::-webkit-scrollbar {
                width: 6px;
            }

            &::-webkit-scrollbar-track {
                background: rgba(0, 0, 0, 0.05);
                border-radius: 3px;
            }

            &::-webkit-scrollbar-thumb {
                background: rgba(0, 0, 0, 0.2);
                border-radius: 3px;

                &:hover {
                    background: rgba(0, 0, 0, 0.3);
                }
            }
        }

        // Reduce indent on mobile (spacing respects user's block gap setting)
        --dsgo-toc-indent: 1rem;

        &__title {
            font-size: 1.125rem;
            margin-bottom: 0.75rem;
        }
    }

    // Tablet and up
    @media (min-width: 783px) {
        // Larger screens can show more content
        &__content {
            max-height: none;
        }
    }
}

// Note: Smooth scroll is handled via JavaScript (view.js:299-302)
// using window.scrollTo({ behavior: 'smooth' }) for better control
// and compatibility with scroll offset settings

// Accessibility: Skip link for screen readers
.dsgo-table-of-contents__skip-link {
    position: absolute;
    left: -9999px;
    top: 0;

    &:focus {
        left: 0;
        z-index: 999;
        padding: 0.5rem 1rem;
        background: #fff;
        border: 2px solid #000;
    }
}

// High contrast mode support
@media (prefers-contrast: high) {
    .dsgo-table-of-contents {
        &__link {
            text-decoration: underline;

            &--active {
                text-decoration: underline;
                text-decoration-thickness: 2px;
            }
        }
    }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
    .dsgo-table-of-contents {
        &__link {
            transition: none;
        }

        &__content {
            scroll-behavior: auto;
        }
    }

    .dsgo-table-of-contents--smooth {
        scroll-behavior: auto;
    }
}
