/**
 * Icon Button Block - Frontend Styles
 *
 * @since 1.0.0
 */

.dsgo-icon-button {
	// Block wrapper is now block-level by default to respect WordPress content width constraints
	// Width behavior is controlled via modifier classes on both wrapper and inner element
	// NOTE: Border-radius is now inherited from theme.json via wp-element-button on the wrapper
	// WordPress border controls will add inline styles to this element, which the wrapper inherits

	// Default border-radius matches the button (WordPress standard pill shape)
	// Will be overridden by WordPress block controls or theme.json
	border-radius: 9999px;
	overflow: hidden; // Clip contents to border-radius

	// ============================================================================
	// WIDTH MODIFIERS
	// ============================================================================
	// These classes control the width behavior of the button
	// The outer wrapper stays block-level, inner wrapper handles inline display

	// Auto width: Button only takes up the space it needs (default behavior)
	&--width-auto {
		// Outer wrapper is block-level, constrained by WordPress content width
		// Inner wrapper is inline-flex with fit-content
		.dsgo-icon-button__wrapper {
			width: fit-content;
		}
	}

	// Full width: Button spans the full container width
	&--width-full {

		.dsgo-icon-button__wrapper {
			display: flex; // Block-level flex instead of inline-flex
			width: 100%;
		}
	}

	// WordPress alignment support
	// Constrain outer wrapper width and use margin for alignment
	&.aligncenter {
		width: fit-content !important;
		margin-left: auto !important;
		margin-right: auto !important;

		.dsgo-icon-button__wrapper {
			width: fit-content !important;
		}
	}

	&.alignleft {
		width: fit-content !important;
		margin-right: auto !important;

		.dsgo-icon-button__wrapper {
			width: fit-content !important;
		}
	}

	&.alignright {
		width: fit-content !important;
		margin-left: auto !important;

		.dsgo-icon-button__wrapper {
			width: fit-content !important;
		}
	}

	// Visual styles and interactions on outer wrapper (where background/border are applied)
	// wp-element-button class inherits theme.json button styles
	text-decoration: none !important;
	transition: all 0.2s ease;
	cursor: pointer;
	font-family: inherit;

	&:hover {
		opacity: 0.9;
		transform: translateY(-1px);
		text-decoration: none !important;
	}

	&:active {
		transform: translateY(0);
		text-decoration: none !important;
	}

	&:focus {
		text-decoration: none !important;
		outline: 2px solid currentcolor;
		outline-offset: 2px;
	}

	// When it's a div (no link), remove cursor pointer
	// EXCEPT for modal close buttons which need pointer cursor
	&:not(a):not([data-dsgo-modal-close]) {
		cursor: default;
	}

	&__wrapper {
		// Inner wrapper only handles layout structure
		// No visual styles - those are on the outer wrapper
		// No wp-block-button__link class, so no theme.json overrides needed
		text-decoration: none !important;
	}

	&__icon {
		// Size and layout styles applied via inline styles
		svg {
			width: 100%;
			height: 100%;
			display: block;
			fill: currentcolor;
		}
	}

	&__text {
		// Text content
		flex: 1 0 auto;
		white-space: nowrap;
	}

	// Ensure outer wrapper keeps border-radius when border is set
	// WordPress may reset border-radius when applying borders
	&[style*="border-width"],
	&[style*="border-style"],
	&[class*="has-border-color"] {
		border-radius: 9999px; // Maintain default pill shape
	}

	// If border-radius is explicitly set, preserve it
	&[style*="border-radius"] {
		// Border-radius already set by WordPress controls, do nothing
	}
}

// CRITICAL: Must duplicate from icons pattern for container parent hover
// Parent container hover: apply button background when parent is hovered
// Uses CSS variable set by parent container (Flex, Grid, Stack)
// CRITICAL: Check if PARENT container has the variable, not the button itself
// CRITICAL: Use __inner wrapper to avoid triggering on outer padding areas
// CRITICAL: Use direct child selector (>) to only affect direct children
// Now targets outer wrapper where background is applied
.dsgo-flex[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-flex__inner > .dsgo-icon-button,
.dsgo-grid[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-grid__inner > .dsgo-icon-button,
.dsgo-stack[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-stack__inner > .dsgo-icon-button {
	background-color: var(--dsgo-parent-hover-button-bg) !important;
	transition: background-color 0.3s ease;
}

// ============================================================================
// HOVER COLORS
// ============================================================================
// Apply custom hover colors set via CSS variables
// These override default hover styles when specified
// Now target outer wrapper where visual styles are applied

.dsgo-icon-button[style*="--dsgo-button-hover-bg"]:hover {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1; // Override default opacity change
}

.dsgo-icon-button[style*="--dsgo-button-hover-color"]:hover {
	color: var(--dsgo-button-hover-color) !important;
}

// ============================================================================
// HOVER ANIMATIONS
// ============================================================================
// Custom hover animations that override the default hover state
// These use ::before or ::after pseudo-elements for advanced effects

// Fill Diagonal - Diagonal sweep fill effect
.dsgo-icon-button.dsgo-icon-button--fill-diagonal {
	// Override default hover effects on outer wrapper
	&:hover {
		opacity: 1;
		transform: none;
	}

	.dsgo-icon-button__wrapper {
		position: relative;
		overflow: hidden;

		&::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.15);
			transition: left 0.4s ease;
			z-index: 0;
			transform: skewX(-20deg);
			transform-origin: top left;
		}

		// Ensure content stays above pseudo-element
		.dsgo-icon-button__icon,
		.dsgo-icon-button__text {
			position: relative;
			z-index: 1;
		}
	}

	&:hover .dsgo-icon-button__wrapper::before {
		left: 100%;
	}
}

// Zoom In - Scale up on hover (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--zoom-in {
	transition: transform 0.3s ease;

	&:hover {
		transform: scale(1.05);
		opacity: 1; // Override default opacity change
	}
}

// Slide Left - Background slides in from right
.dsgo-icon-button.dsgo-icon-button--slide-left {
	// Override default hover effects on outer wrapper
	&:hover {
		opacity: 1;
		transform: none;
	}

	.dsgo-icon-button__wrapper {
		position: relative;
		overflow: hidden;

		&::before {
			content: '';
			position: absolute;
			top: 0;
			right: -100%;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.15);
			transition: right 0.3s ease;
			z-index: 0;
		}

		.dsgo-icon-button__icon,
		.dsgo-icon-button__text {
			position: relative;
			z-index: 1;
		}
	}

	&:hover .dsgo-icon-button__wrapper::before {
		right: 0;
	}
}

// Slide Right - Background slides in from left
.dsgo-icon-button.dsgo-icon-button--slide-right {
	// Override default hover effects on outer wrapper
	&:hover {
		opacity: 1;
		transform: none;
	}

	.dsgo-icon-button__wrapper {
		position: relative;
		overflow: hidden;

		&::before {
			content: '';
			position: absolute;
			top: 0;
			left: -100%;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.15);
			transition: left 0.3s ease;
			z-index: 0;
		}

		.dsgo-icon-button__icon,
		.dsgo-icon-button__text {
			position: relative;
			z-index: 1;
		}
	}

	&:hover .dsgo-icon-button__wrapper::before {
		left: 0;
	}
}

// Slide Down - Background slides down from top
.dsgo-icon-button.dsgo-icon-button--slide-down {
	// Override default hover effects on outer wrapper
	&:hover {
		opacity: 1;
		transform: none;
	}

	.dsgo-icon-button__wrapper {
		position: relative;
		overflow: hidden;

		&::before {
			content: '';
			position: absolute;
			top: -100%;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.15);
			transition: top 0.3s ease;
			z-index: 0;
		}

		.dsgo-icon-button__icon,
		.dsgo-icon-button__text {
			position: relative;
			z-index: 1;
		}
	}

	&:hover .dsgo-icon-button__wrapper::before {
		top: 0;
	}
}

// Slide Up - Background slides up from bottom
.dsgo-icon-button.dsgo-icon-button--slide-up {
	// Override default hover effects on outer wrapper
	&:hover {
		opacity: 1;
		transform: none;
	}

	.dsgo-icon-button__wrapper {
		position: relative;
		overflow: hidden;

		&::before {
			content: '';
			position: absolute;
			bottom: -100%;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.15);
			transition: bottom 0.3s ease;
			z-index: 0;
		}

		.dsgo-icon-button__icon,
		.dsgo-icon-button__text {
			position: relative;
			z-index: 1;
		}
	}

	&:hover .dsgo-icon-button__wrapper::before {
		bottom: 0;
	}
}

// Border Pulse - Animated border effect (applies to outer block wrapper)
// Animates the border set via WordPress border controls
.dsgo-icon-button.dsgo-icon-button--border-pulse {
	transition: border-width 0.3s ease;

	&:hover {
		animation: dsgo-border-pulse 1s ease infinite;
		opacity: 1; // Override default opacity change
		transform: none; // Override default transform
	}
}

@keyframes dsgo-border-pulse {

	0%,
	100% {
		border-width: var(--wp--style--border-width, 2px);
	}

	50% {
		border-width: calc(var(--wp--style--border-width, 2px) * 2);
	}
}

// Border Glow - Glowing border effect (applies to outer wrapper)
.dsgo-icon-button.dsgo-icon-button--border-glow {
	position: relative;
	transition: all 0.3s ease;

	&:hover {
		opacity: 1;
		transform: none;
		box-shadow: 0 0 15px currentcolor, 0 0 30px currentcolor, 0 0 45px currentcolor;
	}
}

// Lift - Elevate with shadow (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--lift {
	transition: all 0.3s ease;

	&:hover {
		transform: translateY(-8px);
		box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2), 0 6px 12px rgba(0, 0, 0, 0.15);
		opacity: 1; // Override default opacity change
	}
}

// Shrink - Subtle scale down (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--shrink {
	transition: transform 0.2s ease;

	&:hover {
		transform: scale(0.95);
		opacity: 1; // Override default opacity change
	}
}
