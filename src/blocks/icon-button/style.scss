/**
 * Icon Button Block - Frontend Styles
 *
 * @since 1.0.0
 */

// Default button styles with low specificity (matches WordPress core button block)
// :where() has 0 specificity, allowing theme.json and block controls to override
// This ensures buttons get default rounded appearance even if WP core button block isn't loaded
:where(.dsgo-icon-button__wrapper.wp-block-button__link) {
	border-radius: 9999px; // Default pill shape (WordPress standard)
}

.dsgo-icon-button {
	// Block wrapper is now block-level by default to respect WordPress content width constraints
	// Width behavior is controlled via modifier classes on both wrapper and inner element
	// NOTE: Border-radius is now inherited from theme.json via wp-element-button on the wrapper
	// WordPress border controls will add inline styles to this element, which the wrapper inherits

	// ============================================================================
	// WIDTH MODIFIERS
	// ============================================================================
	// These classes control the width behavior of the button
	// The outer wrapper stays block-level, inner wrapper handles inline display

	// Auto width: Button only takes up the space it needs (default behavior)
	&--width-auto {
		// Outer wrapper is block-level, constrained by WordPress content width
		// Inner wrapper is inline-flex with fit-content
		.dsgo-icon-button__wrapper {
			width: fit-content;
		}
	}

	// Full width: Button spans the full container width
	&--width-full {

		.dsgo-icon-button__wrapper {
			display: flex; // Block-level flex instead of inline-flex
			width: 100%;
		}
	}

	// WordPress alignment support: Make alignment classes work
	// CRITICAL: aligncenter requires block display to work with margin: auto
	&.aligncenter {
		display: block !important;
		text-align: center;

		.dsgo-icon-button__wrapper {
			margin-left: auto;
			margin-right: auto;
		}
	}

	&.alignleft {
		display: block !important;
		text-align: left;
	}

	&.alignright {
		display: block !important;
		text-align: right;
	}

	&__wrapper {
		// wp-element-button class inherits theme.json button styles (colors, padding, border-radius, etc.)
		// Priority order (highest to lowest):
		// 1. WordPress block controls (inline styles) - highest priority
		// 2. FSE customizations to Icon Button specifically
		// 3. FSE customizations to core Button element (styles.elements.button)
		// 4. Theme defaults from theme.json - lowest priority

		// Structural styles only - visual styles come from wp-element-button (theme.json)
		overflow: hidden; // CRITICAL: Clip background to border-radius
		text-decoration: none !important;
		transition: all 0.2s ease;
		cursor: pointer;
		font-family: inherit;
		font-size: inherit;

		&:hover {
			opacity: 0.9;
			transform: translateY(-1px);
			text-decoration: none !important;
		}

		&:active {
			transform: translateY(0);
			text-decoration: none !important;
		}

		&:focus {
			text-decoration: none !important;
			outline: 2px solid currentcolor;
			outline-offset: 2px;
		}

		// When it's a div (no link), remove cursor pointer
		// EXCEPT for modal close buttons which need pointer cursor
		&:not(a):not([data-dsgo-modal-close]) {
			cursor: default;
		}
	}

	&__icon {
		// Size and layout styles applied via inline styles
		svg {
			width: 100%;
			height: 100%;
			display: block;
			fill: currentcolor;
		}
	}

	&__text {
		// Text content
		flex: 1 0 auto;
		white-space: nowrap;
	}

	// CRITICAL: Inherit border-radius from parent when set via WordPress block controls
	// WordPress applies border-radius to the outer wrapper, but background is on inner wrapper
	&[style*="border-radius"] .dsgo-icon-button__wrapper,
	&[style*="border-top-left-radius"] .dsgo-icon-button__wrapper,
	&[style*="border-top-right-radius"] .dsgo-icon-button__wrapper,
	&[style*="border-bottom-left-radius"] .dsgo-icon-button__wrapper,
	&[style*="border-bottom-right-radius"] .dsgo-icon-button__wrapper {
		border-radius: inherit;
	}
}

// CRITICAL: Must duplicate from icons pattern for container parent hover
// Parent container hover: apply button background when parent is hovered
// Uses CSS variable set by parent container (Flex, Grid, Stack)
// CRITICAL: Check if PARENT container has the variable, not the button itself
// CRITICAL: Use __inner wrapper to avoid triggering on outer padding areas
// CRITICAL: Use direct child selector (>) to only affect direct children
.dsgo-flex[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-flex__inner > .dsgo-icon-button .dsgo-icon-button__wrapper,
.dsgo-grid[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-grid__inner > .dsgo-icon-button .dsgo-icon-button__wrapper,
.dsgo-stack[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-stack__inner > .dsgo-icon-button .dsgo-icon-button__wrapper {
	background-color: var(--dsgo-parent-hover-button-bg) !important;
	transition: background-color 0.3s ease;
}

// ============================================================================
// HOVER COLORS
// ============================================================================
// Apply custom hover colors set via CSS variables
// These override default hover styles when specified

.dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"]:hover {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1; // Override default opacity change
}

.dsgo-icon-button__wrapper[style*="--dsgo-button-hover-color"]:hover {
	color: var(--dsgo-button-hover-color) !important;
}

// ============================================================================
// HOVER ANIMATIONS
// ============================================================================
// Custom hover animations that override the default hover state
// These use ::before or ::after pseudo-elements for advanced effects

// Fill Diagonal - Diagonal sweep fill effect
.dsgo-icon-button.dsgo-icon-button--fill-diagonal .dsgo-icon-button__wrapper {
	position: relative;
	overflow: hidden;

	&::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.15);
		transition: left 0.4s ease;
		z-index: 0;
		transform: skewX(-20deg);
		transform-origin: top left;
	}

	&:hover::before {
		left: 100%;
	}

	// Ensure content stays above pseudo-element
	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}
}

// Zoom In - Scale up on hover (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--zoom-in {
	transition: transform 0.3s ease;

	&:hover {
		transform: scale(1.05);
	}

	// Prevent default button hover effects
	.dsgo-icon-button__wrapper:hover {
		opacity: 1;
		transform: none;
	}
}

// Slide Left - Background slides in from right
.dsgo-icon-button.dsgo-icon-button--slide-left .dsgo-icon-button__wrapper {
	position: relative;
	overflow: hidden;

	&::before {
		content: '';
		position: absolute;
		top: 0;
		right: -100%;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.15);
		transition: right 0.3s ease;
		z-index: 0;
	}

	&:hover::before {
		right: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover {
		opacity: 1;
		transform: none;
	}
}

// Slide Right - Background slides in from left
.dsgo-icon-button.dsgo-icon-button--slide-right .dsgo-icon-button__wrapper {
	position: relative;
	overflow: hidden;

	&::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.15);
		transition: left 0.3s ease;
		z-index: 0;
	}

	&:hover::before {
		left: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover {
		opacity: 1;
		transform: none;
	}
}

// Slide Down - Background slides down from top
.dsgo-icon-button.dsgo-icon-button--slide-down .dsgo-icon-button__wrapper {
	position: relative;
	overflow: hidden;

	&::before {
		content: '';
		position: absolute;
		top: -100%;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.15);
		transition: top 0.3s ease;
		z-index: 0;
	}

	&:hover::before {
		top: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover {
		opacity: 1;
		transform: none;
	}
}

// Slide Up - Background slides up from bottom
.dsgo-icon-button.dsgo-icon-button--slide-up .dsgo-icon-button__wrapper {
	position: relative;
	overflow: hidden;

	&::before {
		content: '';
		position: absolute;
		bottom: -100%;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.15);
		transition: bottom 0.3s ease;
		z-index: 0;
	}

	&:hover::before {
		bottom: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover {
		opacity: 1;
		transform: none;
	}
}

// Border Pulse - Animated border effect (applies to outer block wrapper)
// Animates the border set via WordPress border controls
.dsgo-icon-button.dsgo-icon-button--border-pulse {
	transition: border-width 0.3s ease;

	&:hover {
		animation: dsgo-border-pulse 1s ease infinite;
	}

	// Prevent default button hover effects on inner wrapper
	.dsgo-icon-button__wrapper:hover {
		opacity: 1;
		transform: none;
	}
}

@keyframes dsgo-border-pulse {

	0%,
	100% {
		border-width: var(--wp--style--border-width, 2px);
	}

	50% {
		border-width: calc(var(--wp--style--border-width, 2px) * 2);
	}
}

// Border Glow - Glowing border effect (applies to button wrapper)
.dsgo-icon-button.dsgo-icon-button--border-glow .dsgo-icon-button__wrapper {
	position: relative;
	transition: all 0.3s ease;

	&:hover {
		opacity: 1;
		transform: none;
		box-shadow: 0 0 15px currentcolor, 0 0 30px currentcolor, 0 0 45px currentcolor;
	}
}

// Lift - Elevate with shadow (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--lift {
	transition: all 0.3s ease;

	&:hover {
		transform: translateY(-8px);
		box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2), 0 6px 12px rgba(0, 0, 0, 0.15);
	}

	// Prevent default button hover effects
	.dsgo-icon-button__wrapper:hover {
		opacity: 1;
		transform: none;
	}
}

// Shrink - Subtle scale down (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--shrink {
	transition: transform 0.2s ease;

	&:hover {
		transform: scale(0.95);
	}

	// Prevent default button hover effects
	.dsgo-icon-button__wrapper:hover {
		opacity: 1;
		transform: none;
	}
}
