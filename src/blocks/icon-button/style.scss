/**
 * Icon Button Block - Frontend Styles
 *
 * @since 1.0.0
 */

// Low-specificity default: allows theme.json Global Styles (.wp-element-button) to override
// when user sets button element styles in Appearance > Editor > Styles > Elements > Buttons.
// :where() has specificity (0,0,0), so WordPress's :root :where(.wp-element-button) at (0,1,0) wins.
// Per-instance inline styles (block border controls) always win over both.
:where(.dsgo-icon-button) {
	border-radius: 9999px; // Default pill shape, overridable by Global Styles
}

.dsgo-icon-button {
	overflow: hidden; // Clip contents to border-radius (from any source)

	// ============================================================================
	// WIDTH & ALIGNMENT
	// ============================================================================
	// Width is controlled via WordPress alignment (alignfull for full-width)

	// Full width: Button spans the full container width (via WordPress alignfull)
	&.alignfull {
		display: flex !important;
		width: 100% !important;
		max-width: 100% !important;
	}

	// WordPress alignment support for non-full-width buttons
	// Constrain button width and use margin for alignment
	// CRITICAL: Must override inline display: inline-flex with display: flex for auto margins to work
	// NOTE: Margins don't use !important so user-set margins can override
	// float: none overrides WordPress flow layout which applies float:left/right to aligned blocks,
	// causing them to sit beside adjacent content (e.g. headings) in Group blocks
	&.aligncenter:not(.alignfull) {
		float: none !important;
		display: flex !important;
		width: fit-content !important;
		margin-left: auto;
		margin-right: auto;
	}

	&.alignleft:not(.alignfull) {
		float: none !important;
		display: flex !important;
		width: fit-content !important;
		margin-right: auto;
	}

	&.alignright:not(.alignfull) {
		float: none !important;
		display: flex !important;
		width: fit-content !important;
		margin-left: auto;
	}

	// Visual styles and interactions on outer wrapper (where background/border are applied)
	// wp-element-button class inherits theme.json button styles
	text-decoration: none !important;
	transition: all 0.2s ease;
	cursor: pointer;
	font-family: inherit;

	&:hover {
		opacity: 0.9;
		transform: translateY(-1px);
		text-decoration: none !important;
	}

	&:active {
		transform: translateY(0);
		text-decoration: none !important;
	}

	&:focus,
	&:focus-within {
		text-decoration: none !important;
	}

	// Single element structure
	// All visual and layout styles are on the main button element

	// Legacy v4 structure: inner wrapper is the focusable element
	&__wrapper {

		&:focus {
			text-decoration: none !important;
		}

		&:active {
			transform: translateY(0);
			text-decoration: none !important;
		}
	}

	&__icon {
		// Size and layout styles applied via inline styles
		svg {
			width: 100%;
			height: 100%;
			display: block;
			fill: currentcolor;
		}
	}

	&__text {
		// Text content
		flex: 1 0 auto;
		white-space: nowrap;
	}
}

// CRITICAL: Must duplicate from icons pattern for container parent hover
// Parent container hover: apply button background when parent is hovered
// Uses CSS variable set by parent container (Flex, Grid, Stack)
// CRITICAL: Check if PARENT container has the variable, not the button itself
// CRITICAL: Use __inner wrapper to avoid triggering on outer padding areas
// CRITICAL: Use direct child selector (>) to only affect direct children
.dsgo-flex[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-flex__inner > .dsgo-icon-button,
.dsgo-grid[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-grid__inner > .dsgo-icon-button,
.dsgo-stack[style*="--dsgo-parent-hover-button-bg"]:hover .dsgo-stack__inner > .dsgo-icon-button {
	background-color: var(--dsgo-parent-hover-button-bg) !important;
	transition: background-color 0.3s ease;
}

// ============================================================================
// HOVER COLORS
// ============================================================================
// Apply custom hover colors set via CSS variables
// These override default hover styles when specified
// Only apply instant background change when there's no animation (animations handle it themselves)
// BACKWARD COMPATIBILITY: v4 had variables on .dsgo-icon-button__wrapper, v5+ has them on .dsgo-icon-button

// No animation - just background color transition
.dsgo-icon-button[style*="--dsgo-button-hover-bg"]:not([class*="dsgo-icon-button--"]):hover,
.dsgo-icon-button:not([class*="dsgo-icon-button--"]):hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: background-color 0.3s ease;
}

// Zoom In - preserve transform transition
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--zoom-in:hover,
.dsgo-icon-button.dsgo-icon-button--zoom-in:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: transform 0.3s ease, background-color 0.3s ease;
}

// Lift - preserve transform and box-shadow transitions
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--lift:hover,
.dsgo-icon-button.dsgo-icon-button--lift:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: transform 0.5s ease, box-shadow 0.5s ease, background-color 0.3s ease;
}

// Shrink - preserve transform transition
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--shrink:hover,
.dsgo-icon-button.dsgo-icon-button--shrink:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: transform 0.4s ease, background-color 0.3s ease;
}

// Border Pulse - preserve border-width transition
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--border-pulse:hover,
.dsgo-icon-button.dsgo-icon-button--border-pulse:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: border-width 0.3s ease, background-color 0.3s ease;
}

// Border Glow - preserve box-shadow transition
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--border-glow:hover,
.dsgo-icon-button.dsgo-icon-button--border-glow:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: all 0.3s ease, background-color 0.3s ease;
}

// Fill Diagonal - background doesn't need to change since pseudo-element covers it
// The pseudo-element creates the fill effect by sliding across and staying in place

// Slide Left - apply background color after slide animation completes
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--slide-left:hover,
.dsgo-icon-button.dsgo-icon-button--slide-left:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: background-color 0.1s ease 0.3s; // Fade in after slide completes
}

// Slide Right - apply background color after slide animation completes
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--slide-right:hover,
.dsgo-icon-button.dsgo-icon-button--slide-right:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: background-color 0.1s ease 0.3s; // Fade in after slide completes
}

// Slide Down - apply background color after slide animation completes
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--slide-down:hover,
.dsgo-icon-button.dsgo-icon-button--slide-down:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: background-color 0.1s ease 0.3s; // Fade in after slide completes
}

// Slide Up - apply background color after slide animation completes
.dsgo-icon-button[style*="--dsgo-button-hover-bg"].dsgo-icon-button--slide-up:hover,
.dsgo-icon-button.dsgo-icon-button--slide-up:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-bg"] {
	background-color: var(--dsgo-button-hover-bg) !important;
	opacity: 1;
	transition: background-color 0.1s ease 0.3s; // Fade in after slide completes
}

// Hover text color - supports both v4 (wrapper) and v5+ (button) structures
.dsgo-icon-button[style*="--dsgo-button-hover-color"]:hover,
.dsgo-icon-button:hover .dsgo-icon-button__wrapper[style*="--dsgo-button-hover-color"] {
	color: var(--dsgo-button-hover-color) !important;
	transition: color 0.3s ease; // Add smooth transition
}

// ============================================================================
// HOVER ANIMATIONS
// ============================================================================
// Custom hover animations that override the default hover state
// These use ::before or ::after pseudo-elements for advanced effects

// Fill Diagonal - Diagonal sweep fill effect
.dsgo-icon-button.dsgo-icon-button--fill-diagonal {
	position: relative;

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}

	&::before {
		content: '';
		position: absolute;
		top: 0;
		left: -150%; // Start further left to account for skew
		width: 150%; // Wider to cover button when skewed
		height: 100%;
		background-color: var(--dsgo-button-hover-bg, rgba(0, 0, 0, 0.15));
		transition: left 0.5s ease; // Smooth slide across
		z-index: 0;
		transform: skewX(-20deg);
		transform-origin: top left;
	}

	// Ensure content stays above pseudo-element
	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover::before {
		left: 0; // Slide to cover entire button
	}
}

// Zoom In - Scale up on hover (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--zoom-in {
	transform: scale(1); // Explicit initial state for smooth first hover
	transition: transform 0.3s ease;

	&:hover {
		transform: scale(1.05);
		opacity: 1; // Override default opacity change
	}
}

// Slide Left - Background slides in from right
.dsgo-icon-button.dsgo-icon-button--slide-left {
	position: relative;

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}

	&::before {
		content: '';
		position: absolute;
		top: 0;
		right: -100%;
		width: 100%;
		height: 100%;
		background-color: var(--dsgo-button-hover-bg, rgba(0, 0, 0, 0.15));
		transition: right 0.3s ease;
		z-index: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover::before {
		right: 0;
	}
}

// Slide Right - Background slides in from left
.dsgo-icon-button.dsgo-icon-button--slide-right {
	position: relative;

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}

	&::before {
		content: '';
		position: absolute;
		top: 0;
		left: -100%;
		width: 100%;
		height: 100%;
		background-color: var(--dsgo-button-hover-bg, rgba(0, 0, 0, 0.15));
		transition: left 0.3s ease;
		z-index: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover::before {
		left: 0;
	}
}

// Slide Down - Background slides down from top
.dsgo-icon-button.dsgo-icon-button--slide-down {
	position: relative;

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}

	&::before {
		content: '';
		position: absolute;
		top: -100%;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: var(--dsgo-button-hover-bg, rgba(0, 0, 0, 0.15));
		transition: top 0.3s ease;
		z-index: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover::before {
		top: 0;
	}
}

// Slide Up - Background slides up from bottom
.dsgo-icon-button.dsgo-icon-button--slide-up {
	position: relative;

	// Override default hover effects
	&:hover {
		opacity: 1;
		transform: none;
	}

	&::before {
		content: '';
		position: absolute;
		bottom: -100%;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: var(--dsgo-button-hover-bg, rgba(0, 0, 0, 0.15));
		transition: bottom 0.3s ease;
		z-index: 0;
	}

	.dsgo-icon-button__icon,
	.dsgo-icon-button__text {
		position: relative;
		z-index: 1;
	}

	&:hover::before {
		bottom: 0;
	}
}

// Border Pulse - Animated border effect using box-shadow
// Creates a pulsing glow effect around the button using the current text color
.dsgo-icon-button.dsgo-icon-button--border-pulse {
	transition: box-shadow 0.3s ease;

	&:hover {
		animation: dsgo-border-pulse 1s ease infinite;
		opacity: 1; // Override default opacity change
		transform: none; // Override default transform
	}
}

@keyframes dsgo-border-pulse {

	0%,
	100% {
		box-shadow: 0 0 0 0 currentcolor;
	}

	50% {
		box-shadow: 0 0 0 4px currentcolor;
	}
}

// Border Glow - Glowing border effect (applies to outer wrapper)
.dsgo-icon-button.dsgo-icon-button--border-glow {
	position: relative;
	transition: all 0.3s ease;

	&:hover {
		opacity: 1;
		transform: none;
		box-shadow: 0 0 15px currentcolor, 0 0 30px currentcolor, 0 0 45px currentcolor;
	}
}

// Lift - Elevate with shadow (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--lift {
	transform: translateY(0); // Explicit initial state for smooth first hover
	transition: transform 0.5s ease, box-shadow 0.5s ease; // Slower, smoother transition

	&:hover {
		transform: translateY(-8px);
		box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2), 0 6px 12px rgba(0, 0, 0, 0.15);
		opacity: 1; // Override default opacity change
	}
}

// Shrink - Subtle scale down (applies to entire block including borders)
.dsgo-icon-button.dsgo-icon-button--shrink {
	transform: scale(1); // Explicit initial state for smooth first hover
	transition: transform 0.4s ease; // Slower, smoother transition

	&:hover {
		transform: scale(0.95);
		opacity: 1; // Override default opacity change
	}
}

// No Hover - Explicit opt-out from hover animations
// Used when user selects "None (No Animation)" to override a site-wide default
.dsgo-icon-button.dsgo-icon-button--no-hover {

	&:hover {
		opacity: 1;
		transform: none;
	}
}
