/**
 * Grid Container Block - Editor Styles
 *
 * Editor-only styles for the Grid Container block.
 * CRITICAL: Responsive column styles must be duplicated from style.scss
 * for editor/frontend parity.
 *
 * @package DesignSetGo
 */

.dsg-grid {
	// Visual indicator in editor
	position: relative;

	&__inner {
		// CRITICAL: Grid container needs full width for proper column distribution
		// Must be duplicated from style.scss for editor/frontend parity
		width: 100%;

		// CRITICAL: Prevent grid items from overflowing their cells
		// Must be duplicated from style.scss for editor/frontend parity
		// Grid items automatically fill their grid cell, so we only need to prevent overflow
		> * {
			min-width: 0;     // Allow shrinking below content width
			min-height: 0;    // Allow shrinking vertically
		}

		// CRITICAL: Block-level elements need full width for text-align to work properly
		// Must be duplicated from style.scss for editor/frontend parity
		// NOTE: Nested containers (.dsg-flex, .dsg-grid, .dsg-stack) don't need width: 100%
		// because grid items automatically fill their cell
		> h1,
		> h2,
		> h3,
		> h4,
		> h5,
		> h6,
		> p,
		> .wp-block-heading,
		> .wp-block-paragraph {
			width: 100%;
		}
	}

	// Show outline when selected (editor-only)
	&.is-selected {
		outline: 1px dashed rgba(37, 99, 235, 0.3);
		outline-offset: -1px;
	}

	// ========================================
	// CRITICAL: Responsive column classes
	// MUST be duplicated from style.scss for editor/frontend parity
	// Desktop columns are set via inline styles (default)
	// Tablet and mobile columns use media queries
	// ========================================

	// Tablet breakpoint (≤ 1024px)
	@media (max-width: 1024px) {
		@for $i from 1 through 12 {
			&.dsg-grid-cols-tablet-#{$i} .dsg-grid__inner {
				grid-template-columns: repeat(#{$i}, 1fr) !important;
			}
		}
	}

	// Mobile breakpoint (≤ 767px)
	@media (max-width: 767px) {
		@for $i from 1 through 12 {
			&.dsg-grid-cols-mobile-#{$i} .dsg-grid__inner {
				grid-template-columns: repeat(#{$i}, 1fr) !important;
			}
		}
	}
}

// CRITICAL: Force grid items and nested layouts to stack properly on mobile
// Must be outside .dsg-grid scope for proper specificity
@media (max-width: 767px) {
	// Force all grid items with column spans to span 1 on mobile
	// High specificity to override inline styles with data-block selectors
	.dsg-grid__inner > [style*="grid-column"],
	.dsg-grid__inner > [data-block][style*="grid-column"],
	.dsg-grid__inner > [data-block] {
		grid-column: span 1 !important;
	}

	// Force nested layouts inside grid items to stack
	.dsg-grid__inner > * {
		// Force any nested grid to single column
		.dsg-grid__inner {
			grid-template-columns: 1fr !important;
		}

		// Force any nested flex to stack vertically
		.dsg-flex__inner {
			flex-direction: column !important;
		}
	}
}

// ========================================
// Hide padding controls for nested containers
// When a container is nested inside another container, padding should default to 0
// Only parent containers should have padding controls visible
// Uses CSS to detect if a grid is nested inside any container block
// ========================================
body:has(.dsg-grid .dsg-grid.is-selected),
body:has(.dsg-flex .dsg-grid.is-selected),
body:has(.dsg-stack .dsg-grid.is-selected) {
	// Hide padding controls in Dimensions panel
	.block-editor-block-inspector__advanced
		.components-panel__body:has(.components-base-control:has([aria-label*='Padding' i])) {
		.components-base-control:has([aria-label*='Padding' i]) {
			display: none !important;
		}
	}
}
